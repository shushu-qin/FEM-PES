function [zgp,wgp] = Quadrature(elem, ngaus) 
% 
% [zgp,wgp] = Quadrature(elem, ngaus)
%
% Input:    
%   elem:   type of element (0 for quadrilaterals and 1 for triangles)
%   ngaus:  number of Gauss points in each element
% Output:   
%   zgp, wgp: Gauss points and weights on the reference element


if elem == 0
    if ngaus == 4    % degree 1
        pos1 = 1/sqrt(3); 
        zgp=[-pos1   -pos1 
                pos1   -pos1 
                pos1    pos1 
               -pos1    pos1]; 
        wgp=[ 1 1 1 1];
    elseif ngaus == 9  % degree 2 
        pos1 = sqrt(3/5);
        zgp=[-pos1   -pos1
                   0   -pos1
                pos1   -pos1
               -pos1     0
                  0      0
                pos1     0
               -pos1    pos1
                  0     pos1
                pos1    pos1];
        pg1=5/9; pg2=8/9; pg3=pg1;
        wgp= [pg1*pg1 pg2*pg1 pg3*pg1 pg1*pg2 pg2*pg2 pg3*pg2 pg1*pg3 pg2*pg3 pg3*pg3];
    elseif ngaus == 16
                pos1 = sqrt(525+70*sqrt(30))/35;
        pos2 = sqrt(525-70*sqrt(30))/35;
        paux = [-pos2;-pos1;pos1;pos2];
        unos = ones(size(paux));
        zgp = [ -pos2*unos    paux
                  -pos1*unos    paux
                   pos1*unos    paux
                   pos2*unos    paux ];
        %
        pes1 = sqrt(30)*(3*sqrt(30)-5)/180;
        pes2 = sqrt(30)*(3*sqrt(30)+5)/180;
        waux = [pes2,pes1,pes1,pes2];
        wgp = [pes2*waux, pes1*waux, pes1*waux, pes2*waux];
    elseif ngaus == 25
        r70 = sqrt(70);
        pos0 = 0;
        pos1 = sqrt(245+14*r70)/21;
        pos2 = sqrt(245-14*r70)/21;
        paux = [-pos2;-pos1;pos0;pos1;pos2];
        unos = ones(size(paux));
        zgp = [ -pos2*unos    paux
                  -pos1*unos    paux
                   pos0*unos    paux
                   pos1*unos    paux
                   pos2*unos    paux ];
        %
        pes1 = (7+5*r70)*3*r70/(100*(35+2*r70));
        pes2 = -(-7+5*r70)*3*r70/(100*(-35+2*r70)); 
        pes0 = 128/225;
        waux = [pes2,pes1,pes0,pes1,pes2];
        wgp = [pes2*waux, pes1*waux, pes0*waux, pes1*waux, pes2*waux];
    elseif ngaus == 36
        pos1 = 0.2386191860831961;
        pos2 = 0.6612093864662645;
        pos3 = 0.9324695142031519;
        paux = [-pos3;-pos2;-pos1;pos1;pos2;pos3];
        unos = ones(size(paux));
        zgp = [ -pos3*unos    paux
                  -pos2*unos    paux
                  -pos1*unos    paux
                   pos1*unos    paux
                   pos2*unos    paux
                   pos3*unos    paux ];
        %
        pes1 = 0.4679139345726880;
        pes2 = 0.3607615730481406;
        pes3 = 0.1713244923791704;
        waux = [pes3,pes2,pes1,pes1,pes2,pes3];
        wgp = [pes3*waux, pes2*waux, pes1*waux, pes1*waux, pes2*waux, pes3*waux];
    elseif ngaus == 49
        pos0 = 0.;
        pos1 = 0.9491079123427587;
        pos2 = 0.4058451513773967;
        pos3 = 0.7415311855993942;
        paux = [-pos3;-pos2;-pos1;pos0;pos1;pos2;pos3];
        unos = ones(size(paux));
        zgp = [ -pos3*unos    paux
                  -pos2*unos    paux
                  -pos1*unos    paux
                   pos0*unos    paux
                   pos1*unos    paux
                   pos2*unos    paux
                   pos3*unos    paux ];
        %
        pes0 = 0.417959183673468;
        pes1 = 0.1294849661688696;
        pes2 = 0.381830050505115;
        pes3 = 0.2797053914892795;
        waux = [pes3,pes2,pes1,pes0,pes1,pes2,pes3];
        wgp = [pes3*waux, pes2*waux, pes1*waux, pes0*waux, pes1*waux, pes2*waux, pes3*waux];
    elseif ngaus == 64
        pos1 = 0.9602898564975361;
        pos2 = 0.7966664774136270;
        pos3 = 0.5255324099163287;
        pos4 = 0.1834346424956494;
        paux = [-pos4;-pos3;-pos2;-pos1;pos1;pos2;pos3;pos4];
        unos = ones(size(paux));
        zgp = [ -pos4*unos    paux
                  -pos3*unos    paux
                  -pos2*unos    paux
                  -pos1*unos    paux
                   pos1*unos    paux
                   pos2*unos    paux
                   pos3*unos    paux
                   pos4*unos    paux ];
        %
        pes1 = 0.1012285362903760;
        pes2 = 0.2223810344533772;
        pes3 = 0.3137066458778922;
        pes4 = 0.362683783378360;
        waux = [pes4,pes3,pes2,pes1,pes1,pes2,pes3,pes4];
        wgp = [pes4*waux,pes3*waux, pes2*waux, pes1*waux, pes1*waux, pes2*waux, pes3*waux, pes4*waux];
    else 
        error(' Unavailable quadrature ') 
    end
elseif elem == 1
    if ngaus == 1  % degree 1
        pos1 = 1/3;
        zgp=[pos1   pos1]; 
        wgp = 1/2; 
    elseif ngaus == 3  % degree 2
        pos1 = 1/2;
        zgp = [pos1   pos1
                 0      pos1
                 pos1   0];
        pes1 = 1/6;
        wgp = [pes1   pes1   pes1];
    elseif ngaus == 4  % degree 3
        zgp=[1/3   1/3
               0.6   0.2
               0.2   0.6
               0.2   0.2];
       wgp = [-27/96   25/96   25/96   25/96]; 
    elseif ngaus == 7   % degree 5
        a = 0.101286507323456338800987361915123;
        b = 0.470142064105115089770441209513447;
        P1 = 0.0629695902724135762978419727500906;
        P2 = 0.0661970763942530903688246939165759;
        zgp=[a       a
               a       1-2*a
               1-2*a   a
               b       b
               b       1-2*b
               1-2*b   b
               1/3     1/3];
        wgp = [P1, P1, P1, P2, P2, P2, 0.1125]; 
    elseif ngaus == 12   % degree 6
        a = 0.0630890144915022283403316028708191;
        b = 0.249286745170910421291638553107019;
        c = 0.0531450498448169473532496716313981; 
        d = 0.310352451033784405416607733956552;
        P1 = 0.0254224531851034084604684045534344;
        P2 = 0.0583931378631896830126448056927897;
        P3 = 0.0414255378091867875967767282102212;
        zgp = [a        a  
                 a        1-2*a
                 1-2*a    a
                 b        b  
                 b        1-2*b
                 1-2*b    b
                 c        d
                 c        1-c-d
                 1-c-d    c
                 1-c-d    d
                 d        1-c-d
                 d        c  ]; 
        wgp = [P1, P1, P1, P2, P2, P2, P3, P3, P3, P3, P3, P3];
    elseif ngaus == 16  % degree 8
        a = 0.170569307751760206622293501491464;
        b = 0.0505472283170309754584235505965989;
        c = 0.459292588292723156028815514494169;
        d = 0.728492392955404281241000379176061;
        e = 0.263112829634638113421785786284643;
        f = 1/3;
        P1 = 0.0516086852673591251408957751460645; 
        P2 = 0.0162292488115990401554629641708902;
        P3 = 0.0475458171336423123969480521942921;
        P4 = 0.0136151570872174971324223450369544;
        P5 = 0.0721578038388935841255455552445323;
        zgp = [a        a
                 a        1-2*a
                 1-2*a    a
                 b        b
                 b        1-2*b
                 1-2*b    b
                 c        c
                 c        1-2*c
                 1-2*c    c
                 d        e
                 d        1-d-e
                 1-d-e    d
                 1-d-e    e
                 e        1-d-e
                 e        d
                 f        f ];
        wgp = [P1*ones(1,3), P2*ones(1,3), P3*ones(1,3), P4*ones(1,6), P5];
    elseif ngaus == 19 % degree 9
        a = 0.333333333333333333333333333333333;    Pa = 0.0485678981413994169096209912536443;
        b = 0.489682519198737627783706924836192;    Pb = 0.0156673501135695352684274156436046;
        c = 0.437089591492936637269930364435354;    Pc = 0.0389137705023871396583696781497019;
        d = 0.188203535619032730240961280467335;    Pd = 0.0398238694636051265164458871320226;
        e = 0.0447295133944527098651065899662763;   Pe = 0.0127888378293490156308393992794999;
        f1 = 0.741198598784498020690079873523423;   Pf = 0.0216417696886446886446886446886446;
        f2 = 0.0368384120547362836348175987833851;
        zgp = [a          a
                 b          b
                 b          1-2*b
                 1-2*b      b
                 c          c
                 c          1-2*c
                 1-2*c      c
                 d          d
                 d          1-2*d
                 1-2*d      d
                 e          e
                 e          1-2*e
                 1-2*e      e
                 f1         f2  
                 f1         1-f1-f2
                 f2         f1    
                 f2         1-f1-f2 
                 1-f1-f2    f1
                 1-f1-f2    f2         
                ];
        wgp = [Pa, Pb*ones(1,3), Pc*ones(1,3), Pd*ones(1,3), Pe*ones(1,3), Pf*ones(1,6)]; 
    elseif ngaus == 25 % degree 10
        a = 0.333333333333333333333333333333333;    Pa = 0.0399472523706198539156235226066932;
        b = 0.425086210602090572969529511638044;    Pb = 0.0355619011161886673196456436993290;
        c = 0.0233088675100001907144663868959796;   Pc = 4.11190934523209775932331018123594*10^(-3);
        d1 = 0.628307400213492556420837666078834;   Pd = 0.0227152961480850090035368146219665; 
        d2 = 0.223766973576973006225686490268204;
        e1 = 0.611313826181397648918755002253901;   Pe = 0.0186799281171526384131182495009876; 
        e2 = 0.358740141864431464578155300723852;
        f1 = 0.821072069985629373373544413472177;   Pf = 0.0154433284422819943912565385023143;
        f2 = 0.143295370426867145305856630617323; 
        
        zgp = [a          a
                 b          b
                 b          1-2*b
                 1-2*b      b
                 c          c
                 c          1-2*c
                 1-2*c      c
                 d1         d2  
                 d1         1-d1-d2
                 d2         d1    
                 d2         1-d1-d2 
                 1-d1-d2    d1
                 1-d1-d2    d2         
                 e1         e2  
                 e1         1-e1-e2
                 e2         e1    
                 e2         1-e1-e2 
                 1-e1-e2    e1
                 1-e1-e2    e2                          
                 f1         f2  
                 f1         1-f1-f2
                 f2         f1    
                 f2         1-f1-f2 
                 1-f1-f2    f1
                 1-f1-f2    f2                          
                 ];
        wgp = [Pa, Pb*ones(1,3), Pc*ones(1,3), Pd*ones(1,6), Pe*ones(1,6), Pf*ones(1,6)];
        
    elseif ngaus == 27 % degree 11
        a = 0.0323649481112758931588480911328593;  Pa = 6.82986550133893097935968864728942e-3; 
        b = 0.119350912282581309581102091581736;   Pb = 0.0180922702517090396691439677721401;
        c = 0.534611048270758309358680864963778;   Pc = 4.63503164480338025330042487596786e-4; %SEGURO???????
        d = 0.203309900431282473351326588944569;   Pd = 0.0296614886903870365579061947507576;
        e = 0.398969302965855222611381867187058;   Pe = 0.0385747674574065614307555344183042;
        f1 = 0.593201213428212752488840882179699;  Pf = 0.0261685559811020355585694685067805;
        f2 = 0.0501781383104946650738269077613887;
        g1 = 0.807489003159792153166724890348745;  Pg = 0.0103538298195703444435161507885086;
        g2 = 0.0210220165361662971236385570923633; 
        
        zgp = [a          a
                 a          1-2*a
                 1-2*a      a
                 b          b
                 b          1-2*b
                 1-2*b      b
                 c          c
                 c          1-2*c
                 1-2*c      c
                 d          d
                 d          1-2*d
                 1-2*d      d
                 e          e
                 e          1-2*e
                 1-2*e      e
                 f1         f2  
                 f1         1-f1-f2
                 f2         f1    
                 f2         1-f1-f2 
                 1-f1-f2    f1
                 1-f1-f2    f2         
                 g1         g2  
                 g1         1-g1-g2
                 g2         g1    
                 g2         1-g1-g2 
                 1-g1-g2    g1
                 1-g1-g2    g2                  
                 ];
        wgp = [Pa*ones(1,3), Pb*ones(1,3), Pc*ones(1,3), Pd*ones(1,3), Pe*ones(1,3), Pf*ones(1,6), Pg*ones(1,6)];         
    elseif ngaus == 28 % degree 11 (there are points on the boundary, so it should not be used with ridge functions)
        a = 0.333333333333333333333333333333333;    Pa = 0.0439886505811161193990465846607278;
        b1 = 0.858870281282636704039173938058347;   Pb = 3.68119189165027713212944752369032*10^(-3);
        b2 = 0.141129718717363295960826061941652; 
        c = 0.0259891409282873952600324854988407;   Pc = 4.37215577686801152475821439991262*10^(-3);
        d = 0.0942875026479224956305697762754049;   Pd = 0.0190407859969674687575121697178070;
        e = 0.494636775017213813741632602306436;    Pe = 9.42772402806564602923839129555767*10^(-3);
        f = 0.207343382614511333452934024112966;    Pf = 0.0360798487723697630620149942932315;
        g = 0.438907805700492095061065381636127;    Pg = 0.0346645693527679499208828254519072;
        h1 = 0.677937654882590401542126141188747;   Ph = 0.0205281577146442833208261574536469; 
        h2 = 0.0448416775891304433090523914688007;

        zgp = [a          a
                 b1         b2  
                 b1         1-b1-b2
                 b2         b1    
                 b2         1-b1-b2 
                 1-b1-b2    b1
                 1-b1-b2    b2
                 c          c
                 c          1-2*c
                 1-2*c      c
                 d          d
                 d          1-2*d
                 1-2*d      d
                 e          e
                 e          1-2*e
                 1-2*e      e
                 f          f
                 f          1-2*f
                 1-2*f      f
                 g          g
                 g          1-2*g
                 1-2*g      g
                 h1         h2  
                 h1         1-h1-h2
                 h2         h1    
                 h2         1-h1-h2 
                 1-h1-h2    h1
                 1-h1-h2    h2
                 ];
        wgp = [Pa, Pb*ones(1,6), Pc*ones(1,3), Pd*ones(1,3), Pe*ones(1,3), Pf*ones(1,3), Pg*ones(1,3), Ph*ones(1,6)];
    elseif ngaus == 36
        a = -1.09732124710628115928776639808403;    Pa = -2.21945896962485538956436213495318e-15;  % SEGURO ??????????
        b = 0.488287850733405315708960132445380;    Pb = 0.0119375420275846679217718138313380;
        c = 0.271000295524474716503595034895827;    Pc = 0.0315948917993914165647154983903209;
        d = 0.0247884310336613610583520745170274;   Pd = 4.02253490826229479991501578944327e-3; 
        e = 0.107120353118147709346761788996197;    Pe = 0.0139280485567761024760117619804009;
        f = 0.440323874478061332339068542230318;    Pf = 0.0253425305335128838728212926073213;
        g1 = 0.850459062644356742678494400238734;   Pg = 7.43354416099169030524698401193993e-3; 
        g2 = 0.0208215208466316169587306885458108; 
        h1 = 0.683758575887968213394629726245143;   Ph = 0.0107878499081378862592389379193987;
        h2 = 0.0229194828048128099474800958462720; 
        i1 = 0.631364930935447484201224024482597;   Pi = 0.0216991653514411836807145325302771;
        i2 = 0.115458022821994138042223119054549; 

        zgp = [a          a  
                 a          1-2*a
                 1-2*a      a
                 b          b  
                 b          1-2*b
                 1-2*b      b
                 c          c
                 c          1-2*c
                 1-2*c      c
                 d          d
                 d          1-2*d
                 1-2*d      d
                 e          e
                 e          1-2*e
                 1-2*e      e
                 f          f
                 f          1-2*f
                 1-2*f      f
                 g1         g2  
                 g1         1-g1-g2
                 g2         g1    
                 g2         1-g1-g2 
                 1-g1-g2    g1
                 1-g1-g2    g2                 
                 h1         h2  
                 h1         1-h1-h2
                 h2         h1    
                 h2         1-h1-h2 
                 1-h1-h2    h1
                 1-h1-h2    h2
                 i1         i2  
                 i1         1-i1-i2
                 i2         i1    
                 i2         1-i1-i2 
                 1-i1-i2    i1
                 1-i1-i2    i2
                 ];
        wgp = [Pa*ones(1,3), Pb*ones(1,3), Pc*ones(1,3), Pd*ones(1,3), Pe*ones(1,3), Pf*ones(1,3), Pg*ones(1,6), Ph*ones(1,6), Pi*ones(1,6)];

    elseif ngaus == 37 % degree 13 (there are points on the boundary, so it should not be used with ridge functions)
        a = 0.333333333333333333333333333333333;    Pa = 0.0293480398063595158995969648597808;
        b = 0.5;                                    Pb = 2.67845189554543044455908674650066*10^(-3); 
        c = 0.0246071886432302181878499494124643;   Pc = 3.92538414805004016372590903990464*10^(-3); 
        d = 0.420308753101194683716920537182100;    Pd = 0.0253344765879434817105476355306468;
        e = 0.227900255506160619646298948153592;    Pe = 0.0250401630452545330803738542916538;
        f = 0.116213058883517905247155321839271;    Pf = 0.0158235572961491595176634480481793;
        g = 0.476602980049079152951254215211496;    Pg = 0.0157462815379843978450278590138683;
        h1 = 0.851775587145410469734660003794168;   Ph = 7.90126610763037567956187298486575*10^(-3);
        h2 = 0.0227978945382486125477207592747430;
        i1 = 0.692797317566660854594116289398433;   Pi = 7.99081889046420266145965132482933*10^(-3); 
        i2 = 0.0162757709910885409437036075960413;
        j1 = 0.637955883864209538412552782122039;   Pj = 0.0182757511120486476280967518782978;
        j2 = 0.0897330604516053590796290561145196;
        
        zgp = [a          a
                 b          b
                 b          1-2*b
                 1-2*b      b
                 c          c
                 c          1-2*c
                 1-2*c      c
                 d          d
                 d          1-2*d
                 1-2*d      d
                 e          e
                 e          1-2*e
                 1-2*e      e
                 f          f
                 f          1-2*f
                 1-2*f      f
                 g          g
                 g          1-2*g
                 1-2*g      g
                 h1         h2  
                 h1         1-h1-h2
                 h2         h1    
                 h2         1-h1-h2 
                 1-h1-h2    h1
                 1-h1-h2    h2
                 i1         i2  
                 i1         1-i1-i2
                 i2         i1    
                 i2         1-i1-i2 
                 1-i1-i2    i1
                 1-i1-i2    i2
                 j1         j2  
                 j1         1-j1-j2
                 j2         j1    
                 j2         1-j1-j2 
                 1-j1-j2    j1
                 1-j1-j2    j2
                 ];
             wgp = [Pa, Pb*ones(1,3), Pc*ones(1,3), Pd*ones(1,3), Pe*ones(1,3), Pf*ones(1,3), Pg*ones(1,3), Ph*ones(1,6), Pi*ones(1,6), Pj*ones(1,6)];
    elseif ngaus == 54 % degree 15
        zgp = [  0.08343840726175   0.45828079636912
                   0.45828079636912   0.45828079636913
                   0.45828079636913   0.08343840726175
                   0.19277907084174   0.40361046457913
                   0.40361046457913   0.40361046457913
                   0.40361046457913   0.19277907084174
                   0.41360566417395   0.29319716791303
                   0.29319716791303   0.29319716791303
                   0.29319716791303   0.41360566417395
                   0.70706442611445   0.14646778694277
                   0.14646778694277   0.14646778694277
                   0.14646778694277   0.70706442611445
                   0.88727426466879   0.05636286766560
                   0.05636286766560   0.05636286766560
                   0.05636286766560   0.88727426466879
                   0.96684974628326   0.01657512685837
                   0.01657512685837   0.01657512685837
                   0.01657512685837   0.96684974628326
                   0.00991220330923   0.23953455415479
                   0.23953455415479   0.75055324253598
                   0.75055324253598   0.00991220330923
                   0.23953455415479   0.00991220330923
                   0.75055324253598   0.23953455415479
                   0.00991220330923   0.75055324253598
                   0.01580377063023   0.40487880731834
                   0.40487880731834   0.57931742205143
                   0.57931742205143   0.01580377063023
                   0.40487880731834   0.01580377063023
                   0.57931742205143   0.40487880731834
                   0.01580377063023   0.57931742205143
                   0.00514360881697   0.09500211311304
                   0.09500211311304   0.89985427806998
                   0.89985427806998   0.00514360881697
                   0.09500211311304   0.00514360881697
                   0.89985427806998   0.09500211311304
                   0.00514360881697   0.89985427806998
                   0.04892232575299   0.14975310732227
                   0.14975310732227   0.80132456692474
                   0.80132456692474   0.04892232575299
                   0.14975310732227   0.04892232575299
                   0.80132456692474   0.14975310732227
                   0.04892232575299   0.80132456692474
                   0.06876874863252   0.28691961244133
                   0.28691961244133   0.64431163892615
                   0.64431163892615   0.06876874863252
                   0.28691961244133   0.06876874863252
                   0.64431163892615   0.28691961244133
                   0.06876874863252   0.64431163892615
                   0.16840441812470   0.28183566809908
                   0.28183566809908   0.54975991377622
                   0.54975991377622   0.16840441812470
                   0.28183566809908   0.16840441812470
                   0.54975991377622   0.28183566809908
                   0.16840441812470   0.54975991377622]; 
        wgp = [ 0.01633090942440   0.01633090942440   0.01633090942440   0.01370640901568   0.01370640901568 ...
                0.01370640901568   0.01325501829935   0.01325501829935   0.01325501829935   0.01460798106824 ...
                0.01460798106824   0.01460798106824   0.00529230403312   0.00529230403312   0.00529230403312 ...
                0.00180732153205   0.00180732153205   0.00180732153205   0.00426387405085   0.00426387405085 ...
                0.00426387405085   0.00426387405085   0.00426387405085   0.00426387405085   0.00695808825835 ...
                0.00695808825835   0.00695808825835   0.00695808825835   0.00695808825835   0.00695808825835 ...
                0.00214596647037   0.00214596647037   0.00214596647037   0.00214596647037   0.00214596647037 ...
                0.00214596647037   0.00811766464089   0.00811766464089   0.00811766464089   0.00811766464089 ...
                0.00811766464089   0.00811766464089   0.01280367046063   0.01280367046063   0.01280367046063 ...
                0.01280367046063   0.01280367046063   0.01280367046063   0.01654409776582   0.01654409776582 ...
                0.01654409776582   0.01654409776582   0.01654409776582   0.01654409776582];
    else
        error(' Unavailable quadrature ') 
    end
else
    error(' Unavailable quadrature ') 
end
